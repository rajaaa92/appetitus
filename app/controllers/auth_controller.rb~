class AuthController < ApplicationController
 def index
  #przypisanie parametrów logowania z formularza
  @name = params[:name]
  @pass = params[:pass]
 
  #poszukiwanie użytkownika po zadanych parametrach
  @authuser = User.where(:name => @name)
 
  #jeżeli użytkownik został odnaleziony i hasło sie zgadza
  if (@authuser.pass = @pass)
   #utwórz wpis w tablicy sesji z ID użytkownika
   session[:user_id] = @authuser.id
  end
 
  #jeżeli istnieje wpis w tablicy sesji
  if(session[:user_id])
   #przekieruj na stronę dla zalogowanych
   redirect_to(:action => "secret_method")
  end
 end
 
	def create
		redirect_to(:action => "index")
  end

 def logout
  #dopóki nie ma wpisu w tablicy sesji
  unless session[:user_id]
   #przekieruj do strony logowania
   redirect_to(:action => "index")
  end
 
  #jeżeli jest wpis z ID użytkownika, usuń go (wylogowanie)
  session[:user_id]=nil
 end
 
 def secret_method
  #jeżeli jest wpis w tablicy sesji
  if(session[:user_id])
   @authuser = User.find(session[:user_id])
   #przypisz do zmiennej nazwe użytkownika
   @logged_as = @authuser.name
			redirect_to(:action => "secret_method")
  else
   redirect_to(:action => "index")
  end
 end
end
